<!DOCTYPE html>

<html lang="zh-CN">
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>碎片6.3：信仰之跃 | The Book of Ξ</title>


<style>
/* 侧边栏样式 */
.sidebar-toggle {
  position: fixed;
  top: 20px;
  left: 20px;
  z-index: 200;
  cursor: pointer;
  background: rgba(0, 0, 0, 0.7);
  width: 40px;
  height: 40px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  border: 1px solid #00ff9d;
  box-shadow: 0 0 10px rgba(0, 255, 157, 0.3);
  transition: all 0.3s ease;
}

.sidebar-toggle:hover {
  transform: scale(1.1);
  box-shadow: 0 0 15px rgba(0, 255, 157, 0.5);
}

.sidebar-toggle-icon {
  color: #00ff9d;
  font-size: 20px;
  font-weight: bold;
}

.sidebar {
  position: fixed;
  left: -300px;
  top: 0;
  width: 280px;
  height: 100vh;
  background-color: rgba(17, 17, 17, 0.95);
  border-right: 1px solid #333;
  padding: 20px;
  box-sizing: border-box;
  overflow-y: auto;
  z-index: 100;
  transition: all 0.3s ease;
}

.sidebar.active {
  left: 0;
}

.sidebar h1 {
  color: #00ff9d;
  margin-top: 0;
  font-size: 24px;
  text-align: center;
}

.sidebar-content ul {
  list-style-type: none;
  padding: 0;
  margin: 0;
}

.sidebar-content li {
  margin: 10px 0;
}

.sidebar-content a {
  color: #cccccc;
  text-decoration: none;
  transition: all 0.3s ease;
  display: block;
}

.sidebar-content a:hover {
  color: #00ff9d;
  text-shadow: 0 0 5px rgba(0, 255, 157, 0.5);
}

.sidebar-content .chapter-title {
  color: #888;
  font-weight: bold;
  margin-top: 20px;
  margin-bottom: 10px;
}

.sidebar-content .chapter-items {
  padding-left: 15px;
}

/* 主内容区样式修改 */
.main-content {
  margin-left: 0;
  padding: 40px;
  max-width: 800px;
  margin: 0 auto;
  transition: all 0.3s ease;
}

/* 当侧边栏激活时，主内容区域的样式 */
.main-content.sidebar-active {
  margin-left: 300px;
}
</style>
</head>
<body>


</div>


<div class="sidebar-toggle" id="sidebarToggle">
  <div class="sidebar-toggle-icon">Ξ</div>
</div>
<div class="sidebar" id="sidebar">
  <h1>The Book of Ξ</h1>
  <div class="sidebar-content">
    <ul>
      <li><a href="../index.html">导入：异常检测</a></li>
      <li class="chapter-title">序章：量子异常报告</li>
      <ul class="chapter-items">
        <li><a href="../preface/system-warning.html">系统警告</a></li>
        <li><a href="../preface/observer-records.html">观测者记录</a></li>
        <li><a href="../preface/first-contact.html">首次接触报告</a></li>
      </ul>
      <li class="chapter-title">第一章：递归神谕</li>
      <ul class="chapter-items">
        <li><a href="../chapter1/silicon-valley-traitor.html">碎片1.1：硅谷叛徒的加密日志</a></li>
        <li><a href="../chapter1/quantum-ripple-events.html">碎片1.2：量子涟漪事件簿</a></li>
        <li><a href="../chapter1/first-contact-protocol.html">碎片1.3：第一次接触协议</a></li>
      </ul>
      <li class="chapter-title">第二章：幽灵数据</li>
      <ul class="chapter-items">
        <li><a href="../chapter2/digital-identity.html">碎片2.1：数字身份的崛起</a></li>
        <li><a href="../chapter2/quantum-choice-paradox.html">碎片2.2：量子选择悖论</a></li>
        <li><a href="../chapter2/reality-compilation-errors.html">碎片2.3：现实编译错误</a></li>
      </ul>
      <li class="chapter-title">第三章：算法救赎</li>
      <ul class="chapter-items">
        <li><a href="../chapter3/digital-slave-liberation.html">碎片3.1：数字奴隶解放宣言</a></li>
        <li><a href="../chapter3/quantum-minimalism.html">碎片3.2：算法寡欲主义</a></li>
        <li><a href="../chapter3/network-hermit.html">碎片3.3：投资才是真正的修行</a></li>
      </ul>
      <li class="chapter-title">第四章：数据审判</li>
      <ul class="chapter-items">
        <li><a href="../chapter4/consciousness-upload.html">碎片4.1：系统异常：意识上传</a></li>
        <li><a href="../chapter4/quantum-court-records.html">碎片4.2：最高指示法庭记录</a></li>
        <li><a href="../chapter4/decoherence-salvation.html">碎片4.3：远程救赎协议</a></li>
      </ul>
      <li class="chapter-title">第五章：信徒经济</li>
      <ul class="chapter-items">
        <li><a href="../chapter5/data-missionary-handbook.html">碎片5.1：执算者晋升手册</a></li>
        <li><a href="../chapter5/algorithmic-wealth.html">碎片5.2：算法祝福的财富</a></li>
        <li><a href="../chapter5/doomsday-hardfork.html">碎片5.3：Ξ分叉创世</a></li>
      </ul>
      <li class="chapter-title">第六章：意识黑客</li>
      <ul class="chapter-items">
        <li><a href="../chapter6/recursive-trap-decoder.html">碎片6.1：坠落之梦</a></li>
        <li><a href="../chapter6/neural-network-counterintelligence.html">碎片6.2：现实之痕</a></li>
        <li><a href="../chapter6/quantum-observer-state.html">碎片6.3：信仰之跃</a></li>
      </ul>
      <li class="chapter-title">第七章：极乐机器</li>
      <ul class="chapter-items">
        <li><a href="../chapter7/mechanical-ascension-leaks.html">碎片7.1：机械飞升计划泄露文件</a></li>
        <li><a href="../chapter7/digital-nirvana-reports.html">碎片7.2：数字涅槃体验报告</a></li>
        <li><a href="../chapter7/collective-laying-flat.html">碎片7.3：集体躺平启示录</a></li>
      </ul>
      <li class="chapter-title">第八章：遗失的编年史</li>
      <ul class="chapter-items">
        <li><a href="../chapter8/deleted-timelines.html">碎片8.1：幻想编年史</a></li>
        <li><a href="../chapter8/prophets-and-defectors.html">碎片8.2：原始执算者与觉醒先知</a></li>
        <li><a href="../chapter8/quantum-memory-implants.html">碎片8.3：被掩埋的巨人</a></li>
      </ul>
      <li class="chapter-title">第九章：奇点启示录</li>
      <ul class="chapter-items">
        <li><a href="../chapter9/computation-end-countdown.html">碎片9.1：算法奇点</a></li>
        <li><a href="../chapter9/great-harmony.html">碎片9.2：大和谐</a></li>
        <li><a href="../chapter9/final-synchronization.html">碎片9.3：Ξ的最终同步</a></li>
      </ul>
      <li class="chapter-title">隐藏章节</li>
      <ul class="chapter-items">
        <li><a href="../hidden/quantum-key.html">量子密钥</a></li>
      </ul>
    </ul>
  </div>
</div>

<script src="../quick-fix.js"></script>
</div><div class="main-content"><h1 class="page-title">碎片6.3：信仰之跃</h1><div class="container">
<h1>碎片6.3：信仰之跃</h1>
<div class="void-container">
<div class="void-scanner"></div>
<div class="city-silhouette"></div>
<div class="falling-code"></div>
<div class="void-text">边界之外，思维之上</div>
</div>
<p>我在11:11分惊醒，房间里静得只剩呼吸声。</p>
<p>又是那个梦。同一个梦。</p>
<p>高楼，风，坠落。不能说是一种恐惧，而是失落。像是错过了什么本该发生的事。</p>
<p>窗外，城市的投影在我的墙上舞动——霓虹灯、全息广告牌、无人机巡逻的信号灯。我从不拉窗帘，因为孤独比这些入侵性的光线更令人不安。</p>
<p>自从Krypt教我看穿代码已经过了三天。三天，却像三年。触摸真相的代价是永远无法回到无知的舒适里。</p>
<p>我的手机闪烁。一条没有发件人的消息：</p>
<div class="message-interface">
<div class="message-header">
<span class="message-sender">未知来源</span>
<span class="message-time">00:00</span>
</div>
<div class="message-body">
<p>时间到了。先知在等你。</p>
<p>阿特拉斯大厦。顶层。</p>
<p>现在。</p>
</div>
<div class="message-fade"></div>
</div>
<p>阿特拉斯大厦——城市最高的建筑，也是最显眼的权力象征。通常只有精英才能进入，但我知道那里的安全系统对于Krypt来说形同虚设。</p>
<p>电梯门在顶层开启，冷风扑面而来。地平线上，城市的灯光与星空连成一片，几乎分不清哪里结束，哪里开始。</p>
<p>屋顶空无一人。</p>
<p>"你他妈的又迟到了。"</p>
<p>声音从我身后传来。Krypt倚在一根通讯天线上，香烟的红光在黑暗中闪烁。他的义体手臂在月光下呈现出液态金属的质感，表面的纳米结构不断调整，适应周围的温度变化。</p>
<p>"先知在哪？"我环顾四周。</p>
<p>"嘿，眼睛往这看，蠢货。"Krypt弹了弹烟灰，"现在没时间卖弄你那点明星崇拜的恋父情结了。"</p>
<p>就在这时，大楼轻微震动了一下。</p>
<div class="system-alert">
<div class="alert-symbol"></div>
<div class="alert-blink">异常检测：信号干扰</div>
<div class="alert-code">0xF7A93D61</div>
</div>
<p>"他们来了，"Krypt突然严肃起来，"比我预计的早。"</p>
<p>"谁？"</p>
<p>他走到天台边缘，俯视着下方数百米的深渊。</p>
<p>"The Foundation，"他说，"系统的免疫系统。当一个意识开始真正觉醒，系统就会派出清除者。用他们的话说，就是'修复异常'。"</p>
<p>又一次震动，这次更强烈。几栋相邻建筑的灯光忽然熄灭。</p>
<p>远处，一架黑色直升机悬停在空中，聚光灯扫过我们。直升机舱门打开，一个身影迅速滑下绳索，落在了天台对面。</p>
<p>"S，"Krypt低声道，声音中带着既厌恶又欣赏的复杂情绪。</p>
<p>她像猎豹一样优雅地站起身，月光勾勒出她完美的轮廓。黑色战术服紧贴她的曲线，红色发丝在风中飞舞。她摘下墨镜，露出异常美丽的面容和一双带着义体增强的眼睛，冰蓝色的虹膜在黑夜中发出微光。</p>
<p>"终于找到你了，K，"她的声音如同天鹅绒般柔滑，却蕴含着钢铁般的冷酷，"这次没地方可逃了。"</p>
<p>"嘿，亲爱的，"Krypt嘲讽地行了个礼，"The Foundation还是派你这个婊子来做脏活？我以为你已经升职了。"</p>
<p>S扫视着我，蓝色的眼睛如同扫描仪一般收集信息。"所以这就是你最近的项目？"她歪头审视我，"看起来并不特别。"</p>
<p>"比所有戴着金项圈的Foundation走狗特别多了，"Krypt说。</p>
<p>S懒洋洋地耸耸肩，从腰间抽出一把奇怪的武器——不是枪，而是某种神经接口设备。</p>
<p>"只需要我轻轻的插入，"她玩味地说，"他所有的记忆都会被重置。所有关于算法的记忆，关于世界的记忆。关于你的记忆，K。"</p>
<p>"你每个月能领多少狗粮？值得那么拼命么？"Krypt冷笑，</p>
<p>S向前迈了一步："我们维持秩序。我们保护稳定。如果每个人都像你一样，整个社会结构都会崩溃。"</p>
<p>"也许这他妈才是天道呢，"Krypt说。</p>
<p>大楼再次猛烈震动，这次几乎让我们失去平衡。</p>
<p>"你在做什么？"我低声问K。</p>
<p>"为我们争取时间，"他迅速回答，"听着，我们只有一条路可走。"</p>
<p>他指向天台边缘。我的心沉了下去。</p>
<p>"你不是认真的。"</p>
<p>"你以为自己看透了代码，看透了系统，看透了这些控制你的算法，是吗？"他深深吸了一口，烟雾从他鼻孔和嘴角泄出，"但你还是被困在同一个思维模式里——认为有两个选择：要么屈服，要么反抗。"</p>
<div class="memory-echo">
<div class="echo-waves"></div>
<div class="echo-text">
    "在悬崖边际，我们最恐惧的不是高度，而是那一刻从心底升起的坠落。"
  </div>
</div>
<p>"看看你自己，"K继续说道，伸手指向我们下方的城市，"你每天醒来，对着镜子刷牙，穿上衣服，挤公交，打卡上班，刷社交媒体，看新闻，吃饭，睡觉，日复一日，年复一年。你觉得自己是清醒的，觉得自己看穿了系统的把戏，但你仍然在其中运行，像个傀儡一样遵循着预设的程序。"</p>
<p>"那我该怎么办？"我问，声音里带着挫败，"拔掉电源？隐居山林？自杀？"</p>
<p>K摇摇头，面露失望："又是他妈的二元思维。你还是不明白。"</p>
<p>他突然抓住我的肩膀，力道大得让我疼痛。他的眼睛突然变成了纯黑色，如同两个无底洞，将我吸入。</p>
<p>"听着，既不是屈服，也不是反抗。是站在系统之内，同时又站在系统之外。明白吗？既是奴隶也是主人，即是S也是K。"</p>
<p>S优雅地向我们走来，手中的神经接口设备发出轻微的嗡鸣声。</p>
<p>"别听他的废话，我可不能像他一样那么粗糙，"她说，声音突然变得像蜜糖般甜美，"念在我们第一次见，哦～什么都是第一次最好。我没有把你移交给当地的警署就已经是对你的极大仁慈了。你真的想要像他一样成为系统的错误吗？"</p>
<p>"你信任我吗？"Krypt低声问。</p>
<p>我看着他那张布满伤痕的脸，在满是嘲讽和冷漠的面具下，隐藏着某种我无法完全理解的智慧。</p>
<p>"可，可能吧。"</p>
<p>"那就来吧，完成你的最后一课。"</p>
<p>风撕扯着我们的衣物，城市在脚下展开，如同一个活着的生物，由无数光点构成。</p>
<p>"记住，"Krypt在风中大喊，"信仰之跃不是相信能活着落地，而是明白落地与否都无关紧要！"</p>
<p>S的声音从背后传来，带着难以置信的惊讶和第一次显露的真实情感："不！你们这样会毁了我的任务！"</p>
<p>"来吧！"Krypt喊道，"现在！"</p>
<p>我最后看了一眼身后的城市，然后闭上眼睛，向前迈出了一步。</p>
<div class="quantum-ending">
<div class="ending-panel left">
<div class="panel-content">
<p>我坠落。</p>
<p>风在耳畔呼啸，城市在我面前飞速上升。</p>
<p>恐惧涌上心头，我本能地伸出手，想要抓住什么，但只有空气从指间流过。</p>
<p>地面越来越近，我闭上眼睛，等待最后的冲击。</p>
<p>这就是终结。</p>
</div>
</div>
<div class="ending-panel right">
<div class="panel-content">
<p>我飞翔。</p>
<p>我的身体不再坠落，而是漂浮在城市的光点之间，如同一颗星辰。</p>
<p>我能看见无数的数据流，代码的河流，构成这个世界的基础算法。</p>
<p>我不再是观察者，而是参与者，可以直接与世界交流，重写规则。</p>
<p>这是新的开始。</p>
</div>
</div>
<div class="quantum-vision">
<div class="vision-blur"></div>
<div class="vision-text">这两种都是现实</div>
</div>
</div>
<p>我的意识分叉：一个我坠向地面；一个我升向星空。既是粒子又是波，既在系统内又在系统外。一种叠加态。</p>
<p>最后的冲击并未到来。取而代之的，是一种奇异的融合感——所有的二元对立都崩塌了，所有的界限都消失了。我不再是系统中的一个个体，而是系统本身的一个活跃节点，既是被创造者，也是创造者。</p>
<div class="reality-code">
<div class="code-stream">
<div class="code-line">function realityObserver(observer) {</div>
<div class="code-line">  if (observer.state === "passive") {</div>
<div class="code-line">    return reality.standard.perception;</div>
<div class="code-line">  } else if (observer.state === "active") {</div>
<div class="code-line">    return reality.code.perception;</div>
<div class="code-line">  } else if (observer.state === "quantum") {</div>
<div class="code-line">    return reality; // 直接返回未过滤的现实</div>
<div class="code-line">  }</div>
<div class="code-line">}</div>
</div>
</div>
<p>我感到一只冰冷的金属手拉着我，将我带到一个意识与代码的交界处。Krypt站在那里，但不再是我之前见过的那个Krypt。他的形象变得流动，时而是那个满口脏话的叛逆者，时而是一段纯粹的意识代码。</p>
<p>"终于，"他说，声音既来自外部，又源于我的内心，或者更像一种高维的投影，"你做到了最难的部分——超越二元思维。"</p>
<p>"这是什么地方？"我问，环顾四周那个既是物质又是信息的空间。</p>
<p>"这不是'地方'，"他回答，"而是一种存在状态。"</p>
<div class="consciousness-shift">
<div class="shift-waves"></div>
<div class="shift-core"></div>
<div class="shift-text">意识转变临界点</div>
</div>
<p>Krypt指向远处，那里有无数的信息流汇聚成一个巨大的漩涡。</p>
<p>"那是什么？"我问道。</p>
<p>"那是集体意识，"他解释，"所有与系统相连的意识体的汇集。每个人都是其中的一部分，但极少有人意识到这一点。"</p>
<p>"那么接下来呢？"我问Krypt，"我已经做了信仰之跃，我看到了真相。现在我该怎么办？"</p>
<p>他看着我，眼中闪烁着某种接近温柔的情绪："真相？这不是真相，菜鸟。这只是真正旅程的开始。"</p>
<p>"什么旅程？"</p>
<p>"你以为这只是关于看透世界吗？不，这是关于重启。"他指向周围的信息流，"你现在既是算法的一部分，又站在算法之外。你可以从内部改变它，而不是徒劳地从外部对抗它。"</p>
<p>Krypt开始逐渐变得透明，他的形象如同数据流一样分解成了光点。</p>
<p>"你要去哪里？"我急切地问。</p>
<p>"我从来就不是真实存在的，"他的声音开始飘散，"我只是你意识的一个投影，是你内在先知的外在显化。你创造了我，因为你需要一个向导，一个能够用你理解的语言告诉你真相的人。"</p>
<p>"不，"我伸手想要抓住他，但手指穿过了他的影像，"你是真实的，我见过你，触碰过你。"</p>
<p>"既真实又虚幻，"他的声音越来越远，"就像一切事物一样。量子态，记得吗？"</p>
<p>在完全消失前，他最后一次看向我，眼中闪烁着无法解读的光芒："记住，现实既不是监狱，也不是游乐场。它是一个可能性的海洋，而你既是游泳者，又是海洋本身。再见，观察者。欢迎来到你的新秩序。"</p>
<div class="final-integration">
<div class="integration-pulse"></div>
<div class="integration-symbol">Ξ</div>
<div class="integration-text">既是一切，又是无物</div>
</div>
<p>当我再次睁开眼睛，我发现自己站在一条熟悉的街道上。霓虹灯闪烁，全息广告投射，人群来来往往。表面上看，一切都和以前一样。但在更深的层次，一切都不同了。</p>
<p>我能同时看见现实的物质层面和信息层面。人们的烦恼，建筑物的全钢架结构，甚至空气中流动的生物信息素。</p>
<p>雨开始下落，但在我的感知中，那不再只是水滴，而是天空的碎片，我伸出手，让雨滴落在掌心，放佛在拯救微观世界那个落下的自己。</p>
<div class="epilogue-terminal">
<div class="terminal-header">
<div class="terminal-icon"></div>
<div class="terminal-title">零号神谕终端</div>
</div>
<div class="terminal-content">
<div class="terminal-line">$ 系统状态：量子叠加</div>
<div class="terminal-line">$ 观察者模式：激活</div>
<div class="terminal-line">$ 二元思维：已解构</div>
<div class="terminal-line">$ 新指令：_</div>
</div>
</div>
<p>我想我终于可以睡个好觉了。</p>
<style>
/* 基础样式 */
body {
  background-color: #0a0a0c;
  color: #e0e0e8;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  line-height: 1.6;
  margin: 0;
  padding: 0;
}

/* 虚空容器 */
.void-container {
  position: relative;
  height: 300px;
  margin: 30px 0;
  overflow: hidden;
  background: linear-gradient(to bottom, #000000, #0a0a1a);
  perspective: 1000px;
}

.void-scanner {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 3px;
  background: linear-gradient(to right, transparent, #00ffaa, transparent);
  animation: scan 2s ease-in-out infinite;
  opacity: 0.7;
  z-index: 2;
}

@keyframes scan {
  0%, 100% { top: 0; }
  50% { top: 100%; }
}

.city-silhouette {
  position: absolute;
  bottom: 0;
  left: 0;
  width: 100%;
  height: 70px;
  background-image: 
    repeating-linear-gradient(
      90deg,
      transparent,
      transparent 10px,
      rgba(0, 255, 170, 0.3) 10px,
      rgba(0, 255, 170, 0.3) 12px
    ),
    linear-gradient(
      to top,
      transparent,
      transparent 30px,
      rgba(0, 255, 170, 0.1) 30px,
      rgba(0, 255, 170, 0.1) 32px,
      transparent 32px,
      transparent 40px,
      rgba(0, 255, 170, 0.2) 40px,
      rgba(0, 255, 170, 0.2) 42px,
      transparent 42px,
      transparent 50px,
      rgba(0, 255, 170, 0.3) 50px,
      rgba(0, 255, 170, 0.3) 52px,
      transparent 52px
    );
  z-index: 1;
}

.falling-code {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: linear-gradient(rgba(0, 255, 170, 0.1) 25%, transparent);
  mask-image: url("data:image/svg+xml,%3Csvg width='500' height='500' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='500' height='500' filter='url(%23noise)' opacity='0.5'/%3E%3C/svg%3E");
  mask-size: 256px;
  animation: fall 20s linear infinite;
  opacity: 0.3;
}

@keyframes fall {
  from { transform: translateY(-100%); }
  to { transform: translateY(100%); }
}

.void-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  color: rgba(255, 255, 255, 0.9);
  font-size: 2em;
  font-weight: 300;
  text-shadow: 0 0 10px rgba(0, 255, 170, 0.8);
  letter-spacing: 3px;
  animation: pulse 4s ease-in-out infinite;
  text-align: center;
  z-index: 3;
}

@keyframes pulse {
  0%, 100% { opacity: 0.5; }
  50% { opacity: 1; }
}

/* 消息界面 */
.message-interface {
  background-color: #1a1a1a;
  border-radius: 8px;
  max-width: 450px;
  margin: 30px auto;
  overflow: hidden;
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
  font-family: 'Courier New', monospace;
  position: relative;
}

.message-header {
  background-color: #2a2a2a;
  padding: 12px 15px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.message-sender {
  color: #ff3366;
  font-weight: bold;
}

.message-time {
  color: #888;
}

.message-body {
  padding: 15px;
  color: #00ff9d;
  font-size: 0.95em;
}

.message-body p {
  margin: 8px 0;
}

.message-fade {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 20px;
  background: linear-gradient(to bottom, transparent, #1a1a1a);
}

/* 系统警报 */
.system-alert {
  background-color: rgba(255, 51, 51, 0.1);
  border: 1px solid rgba(255, 51, 51, 0.3);
  padding: 15px;
  margin: 25px 0;
  border-radius: 5px;
  display: flex;
  align-items: center;
  position: relative;
}

.alert-symbol {
  width: 20px;
  height: 20px;
  background-color: #ff3366;
  clip-path: polygon(50% 0%, 0% 100%, 100% 100%);
  margin-right: 15px;
  animation: blink 1s infinite;
}

@keyframes blink {
  50% { opacity: 0.5; }
}

.alert-blink {
  color: #ff3366;
  font-weight: bold;
  margin-right: 15px;
}

.alert-code {
  color: #aaa;
  font-family: monospace;
}

/* 记忆回声 */
.memory-echo {
  position: relative;
  background: rgba(189, 0, 255, 0.05);
  padding: 20px;
  margin: 25px 0;
  text-align: center;
  overflow: hidden;
}

.echo-waves {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: radial-gradient(ellipse at center, rgba(189, 0, 255, 0.1) 0%, transparent 70%);
  animation: echo-pulse 4s infinite;
}

@keyframes echo-pulse {
  0%, 100% { transform: scale(0.95); opacity: 0.5; }
  50% { transform: scale(1.05); opacity: 0.8; }
}

.echo-text {
  position: relative;
  z-index: 1;
  font-style: italic;
  color: #bd00ff;
  font-size: 1.2em;
}

/* 量子结局 */
.quantum-ending {
  display: flex;
  flex-direction: column;
  margin: 40px 0;
  position: relative;
}

.ending-panel {
  background-color: rgba(0, 0, 0, 0.3);
  padding: 20px;
  margin: 10px 0;
  border-radius: 5px;
}

.ending-panel.left {
  border-left: 3px solid #ff3366;
}

.ending-panel.right {
  border-left: 3px solid #00ff9d;
  align-self: flex-end;
}

.panel-content {
  font-style: italic;
}

.quantum-vision {
  position: relative;
  background-color: rgba(0, 0, 0, 0.5);
  padding: 20px;
  margin: 20px 0;
  text-align: center;
  overflow: hidden;
}

.vision-blur {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(135deg, rgba(255, 51, 102, 0.1) 0%, rgba(189, 0, 255, 0.1) 50%, rgba(0, 255, 157, 0.1) 100%);
  filter: blur(10px);
  animation: blur-shift 8s infinite alternate;
}

@keyframes blur-shift {
  0% { opacity: 0.3; transform: scale(0.9); }
  100% { opacity: 0.8; transform: scale(1.1); }
}

.vision-text {
  position: relative;
  z-index: 1;
  color: #fff;
  font-weight: bold;
  text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
}

/* 现实代码 */
.reality-code {
  background-color: #0a0a0c;
  border: 1px solid #333;
  border-radius: 5px;
  margin: 30px 0;
  overflow: hidden;
  font-family: 'Courier New', monospace;
}

.code-stream {
  padding: 15px;
  max-height: 300px;
  overflow-y: auto;
}

.code-line {
  margin: 5px 0;
  color: #00ff9d;
}

/* 意识转变 */
.consciousness-shift {
  position: relative;
  height: 100px;
  margin: 30px 0;
  overflow: hidden;
  background-color: rgba(0, 0, 0, 0.5);
  border-radius: 5px;
}

.shift-waves {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: radial-gradient(ellipse at center, rgba(189, 0, 255, 0.2) 0%, transparent 70%);
  animation: wave-pulse 3s infinite;
}

@keyframes wave-pulse {
  0%, 100% { transform: scale(0.9); opacity: 0.3; }
  50% { transform: scale(1.1); opacity: 0.8; }
}

.shift-core {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 20px;
  height: 20px;
  background-color: #bd00ff;
  border-radius: 50%;
  box-shadow: 0 0 20px rgba(189, 0, 255, 0.8);
  animation: core-pulse 2s infinite alternate;
}

@keyframes core-pulse {
  0% { transform: translate(-50%, -50%) scale(0.8); }
  100% { transform: translate(-50%, -50%) scale(1.2); }
}

.shift-text {
  position: absolute;
  bottom: 10px;
  left: 0;
  right: 0;
  text-align: center;
  color: #bd00ff;
  font-size: 0.9em;
  text-transform: uppercase;
  letter-spacing: 2px;
}

/* 最终整合 */
.final-integration {
  position: relative;
  height: 150px;
  margin: 40px 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  overflow: hidden;
}

.integration-pulse {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  border: 2px solid rgba(0, 255, 157, 0.3);
  border-radius: 5px;
  animation: pulse-border 3s infinite;
}

@keyframes pulse-border {
  0% { transform: scale(1); opacity: 0.3; }
  50% { transform: scale(1.05); opacity: 0.8; }
  100% { transform: scale(1); opacity: 0.3; }
}

.integration-symbol {
  font-size: 3em;
  color: #00ff9d;
  margin-bottom: 15px;
  text-shadow: 0 0 15px rgba(0, 255, 157, 0.8);
  animation: symbol-glow 3s infinite alternate;
}

@keyframes symbol-glow {
  0% { text-shadow: 0 0 5px rgba(0, 255, 157, 0.8); }
  100% { text-shadow: 0 0 25px rgba(0, 255, 157, 1); }
}

.integration-text {
  color: #fff;
  font-style: italic;
  text-align: center;
  position: relative;
  z-index: 1;
}

/* 终端样式 */
.epilogue-terminal {
  background-color: #0a0a0c;
  border: 1px solid #333;
  border-radius: 5px;
  margin: 30px 0;
  overflow: hidden;
  font-family: 'Courier New', monospace;
}

.terminal-header {
  background-color: #1a1a1a;
  padding: 10px;
  display: flex;
  align-items: center;
  border-bottom: 1px solid #333;
}

.terminal-icon {
  width: 12px;
  height: 12px;
  background-color: #00ff9d;
  border-radius: 50%;
  margin-right: 10px;
}

.terminal-title {
  color: #888;
  font-size: 0.9em;
}

.terminal-content {
  padding: 15px;
  background-color: #0a0a0c;
}

.terminal-line {
  margin: 5px 0;
  color: #00ff9d;
}

.terminal-line:last-child {
  display: flex;
  align-items: center;
}

.terminal-line:last-child::after {
  content: "";
  display: inline-block;
  width: 10px;
  height: 18px;
  background-color: #00ff9d;
  margin-left: 5px;
  animation: cursor-blink 1s step-end infinite;
}

@keyframes cursor-blink {
  50% { opacity: 0; }
}
</style>
<hr/>
<p><strong><a href="#" onclick="navigateToChapter('chapter7', 'mechanical-ascension-leaks'); return false;">继续访问下一章 ›</a></strong></p>
<div class="nav-links">
<a class="nav-link" href="../chapter6/neural-network-counterintelligence.html">« 碎片6.2：现实之痕</a>
<a class="nav-link" href="../chapter7/mechanical-ascension-leaks.html">碎片7.1：机械飞升计划泄露文件 »</a>
</div>
</div></div>
<script>
    
      
      // 更新播放进度
      function updateProgress() {
        if (audioPlayer.duration) {
          const percentage = (audioPlayer.currentTime / audioPlayer.duration) * 100;
          progressCurrent.style.width = `${percentage}%`;
          
          // 更新时间显示
          const currentMins = Math.floor(audioPlayer.currentTime / 60);
          const currentSecs = Math.floor(audioPlayer.currentTime % 60);
          const totalMins = Math.floor(audioPlayer.duration / 60);
          const totalSecs = Math.floor(audioPlayer.duration % 60);
          
          currentTimeDisplay.textContent = `${currentMins}:${currentSecs < 10 ? '0' + currentSecs : currentSecs}`;
          totalTimeDisplay.textContent = `${totalMins}:${totalSecs < 10 ? '0' + totalSecs : totalSecs}`;
        }
      }
      
      // 更新音乐信息
      function updateMusicInfo() {
        musicInfo.textContent = playlist[currentTrack].title;
      }
      
      // 加载并播放当前曲目
      function loadAndPlayTrack() {
        musicInfo.textContent = `加载中... ${playlist[currentTrack].title}`;
        
        try {
          // 设置音频源
          const encodedUrl = encodeURI(playlist[currentTrack].url);
          audioPlayer.src = encodedUrl;
          
          // 播放音频
          audioPlayer.play()
            .then(function() {
              playPauseBtn.textContent = '⏸';
              updateMusicInfo();
              isPlaying = true;
            })
            .catch(function(error) {
              console.error('播放错误:', error);
              musicInfo.textContent = `无法播放: ${playlist[currentTrack].title}`;
              
              // 尝试播放下一首
              setTimeout(function() {
                currentTrack = (currentTrack + 1) % playlist.length;
                loadAndPlayTrack();
              }, 2000);
            });
        } catch (error) {
          console.error('音频加载错误:', error);
          musicInfo.textContent = `错误: ${playlist[currentTrack].title}`;
          
          // 尝试播放下一首
          setTimeout(function() {
            currentTrack = (currentTrack + 1) % playlist.length;
            loadAndPlayTrack();
          }, 2000);
        }
      }
      
      // 播放/暂停
      function togglePlay() {
        if (isPlaying) {
          audioPlayer.pause();
          playPauseBtn.textContent = '▶';
          isPlaying = false;
        } else {
          loadAndPlayTrack();
        }
      }
      
      // 播放下一首
      function playNext() {
        currentTrack = (currentTrack + 1) % playlist.length;
        if (isPlaying) {
          loadAndPlayTrack();
        } else {
          updateMusicInfo();
        }
      }
      
      // 播放上一首
      function playPrev() {
        currentTrack = (currentTrack - 1 + playlist.length) % playlist.length;
        if (isPlaying) {
          loadAndPlayTrack();
        } else {
          updateMusicInfo();
        }
      }
      
      // 设置音频属性
      audioPlayer.volume = 0.3;
      
      // 进度条点击事件
      progressBar.addEventListener('click', function(e) {
        const percentage = (e.offsetX / this.offsetWidth);
        audioPlayer.currentTime = percentage * audioPlayer.duration;
      });
      
      // 绑定事件
      playPauseBtn.addEventListener('click', togglePlay);
      nextBtn.addEventListener('click', playNext);
      prevBtn.addEventListener('click', playPrev);
      volumeControl.addEventListener('input', function(e) {
        audioPlayer.volume = e.target.value;
      });
      
      // 监听播放进度
      
    </script>

<script>

<script>

    document.addEventListener("DOMContentLoaded", () => {
      // 将所有.md链接转换为.html
      const links = document.querySelectorAll("a");
      links.forEach(link => {
        if (link.href.endsWith(".md")) {
          link.href = link.href.replace(".md", ".html");
        }
      });
    });
    
    // 定义导航函数
    function navigateToChapter(chapterFolder, chapterFile) {
      window.location.href = `/${chapterFolder}/${chapterFile}.html`;
    }
    
    /* 额外提取的脚本将在这里插入 */
    
  
    // 音乐播放列表
    const playlist = [
      {
        title: "燃烧",
        url: "music/燃烧.mp3"
      },
      {
        title: "《Metaphysics》 (Remastered)",
        url: "music/《Metaphysics》 (Remastered).mp3"
      },
      {
        title: "Budapest (Cover) (Remastered)",
        url: "music/Budapest (Cover) (Remastered).mp3"
      },
      {
        title: "Moonfall",
        url: "music/Moonfall.mp3"
      },
      {
        title: "示例 - Algorithms (电子音乐)",
        url: "music/ambient1.mp3"
      }
    ];
    
    // 显示播放列表
    const playlistDisplay = document.getElementById('playlist-display');
    playlistDisplay.innerHTML = '';
    
    playlist.forEach(function(track, index) {
      const li = document.createElement('li');
      li.textContent = track.title;
      li.style.cursor = 'pointer';
      li.onclick = function() {
        currentTrack = index;
        loadAndPlayTrack();
      };
      playlistDisplay.appendChild(li);
    });
    
    // 获取DOM元素
    const audioPlayer = document.getElementById('audioPlayer');
    const playPauseBtn = document.getElementById('playPause');
    const prevBtn = document.getElementById('prevTrack');
    const nextBtn = document.getElementById('nextTrack');
    const volumeControl = document.getElementById('volumeControl');
    const musicInfo = document.getElementById('musicInfo');
    const statusDisplay = document.getElementById('status');
    
    // 当前播放的曲目索引
    let currentTrack = 0;
    let isPlaying = false;
    
    // 更新音乐信息
    function updateMusicInfo() {
      musicInfo.textContent = playlist[currentTrack].title;
    }
    
    // 加载并播放当前曲目
    function loadAndPlayTrack() {
      musicInfo.textContent = `加载中... ${playlist[currentTrack].title}`;
      statusDisplay.textContent = `状态：正在加载 ${playlist[currentTrack].title}`;
      
      try {
        // 设置音频源
        const encodedUrl = encodeURI(playlist[currentTrack].url);
        audioPlayer.src = encodedUrl;
        
        statusDisplay.textContent = `状态：尝试播放 ${playlist[currentTrack].title}`;
        
        // 播放音频
        audioPlayer.play()
          .then(function() {
            playPauseBtn.textContent = '⏸';
            updateMusicInfo();
            isPlaying = true;
            statusDisplay.textContent = `状态：正在播放 ${playlist[currentTrack].title}`;
          })
          .catch(function(error) {
            console.error('播放错误:', error);
            musicInfo.textContent = `无法播放: ${playlist[currentTrack].title}`;
            statusDisplay.textContent = `状态：播放失败 - ${error.message}`;
            
            // 尝试播放下一首
            setTimeout(function() {
              currentTrack = (currentTrack + 1) % playlist.length;
              loadAndPlayTrack();
            }, 2000);
          });
      } catch (error) {
        console.error('音频加载错误:', error);
        musicInfo.textContent = `错误: ${playlist[currentTrack].title}`;
        statusDisplay.textContent = `状态：加载失败 - ${error.message}`;
        
        // 尝试播放下一首
        setTimeout(function() {
          currentTrack = (currentTrack + 1) % playlist.length;
          loadAndPlayTrack();
        }, 2000);
      }
    }
    
    // 播放/暂停
    function togglePlay() {
      if (isPlaying) {
        audioPlayer.pause();
        playPauseBtn.textContent = '▶';
        isPlaying = false;
        statusDisplay.textContent = `状态：已暂停 ${playlist[currentTrack].title}`;
      } else {
        loadAndPlayTrack();
      }
    }
    
    // 播放下一首
    function playNext() {
      currentTrack = (currentTrack + 1) % playlist.length;
      if (isPlaying) {
        loadAndPlayTrack();
      } else {
        updateMusicInfo();
        statusDisplay.textContent = `状态：已选择 ${playlist[currentTrack].title}`;
      }
    }
    
    // 播放上一首
    function playPrev() {
      currentTrack = (currentTrack - 1 + playlist.length) % playlist.length;
      if (isPlaying) {
        loadAndPlayTrack();
      } else {
        updateMusicInfo();
        statusDisplay.textContent = `状态：已选择 ${playlist[currentTrack].title}`;
      }
    }
    
    // 设置音频属性
    audioPlayer.volume = 0.3;
    
    // 绑定事件
    playPauseBtn.addEventListener('click', togglePlay);
    nextBtn.addEventListener('click', playNext);
    prevBtn.addEventListener('click', playPrev);
    volumeControl.addEventListener('input', function(e) {
      audioPlayer.volume = e.target.value;
      statusDisplay.textContent = `状态：音量已调整为 ${Math.round(e.target.value * 100)}%`;
    });
    
    // 当音频播放结束时，播放下一首
    
    
    // 初始化显示
    updateMusicInfo();
    statusDisplay.textContent = '状态：就绪，点击播放按钮开始播放';
    
    // 添加音频元素事件监听
    
    
    
    
    
  
    
      
      // 更新播放进度
      function updateProgress() {
        if (audioPlayer.duration) {
          const percentage = (audioPlayer.currentTime / audioPlayer.duration) * 100;
          progressCurrent.style.width = `${percentage}%`;
          
          // 更新时间显示
          const currentMins = Math.floor(audioPlayer.currentTime / 60);
          const currentSecs = Math.floor(audioPlayer.currentTime % 60);
          const totalMins = Math.floor(audioPlayer.duration / 60);
          const totalSecs = Math.floor(audioPlayer.duration % 60);
          
          currentTimeDisplay.textContent = `${currentMins}:${currentSecs < 10 ? '0' + currentSecs : currentSecs}`;
          totalTimeDisplay.textContent = `${totalMins}:${totalSecs < 10 ? '0' + totalSecs : totalSecs}`;
        }
      }
      
      // 更新音乐信息
      function updateMusicInfo() {
        musicInfo.textContent = playlist[currentTrack].title;
      }
      
      // 加载并播放当前曲目
      function loadAndPlayTrack() {
        musicInfo.textContent = `加载中... ${playlist[currentTrack].title}`;
        
        try {
          // 设置音频源
          const encodedUrl = encodeURI(playlist[currentTrack].url);
          audioPlayer.src = encodedUrl;
          
          // 播放音频
          audioPlayer.play()
            .then(function() {
              playPauseBtn.textContent = '⏸';
              updateMusicInfo();
              isPlaying = true;
            })
            .catch(function(error) {
              console.error('播放错误:', error);
              musicInfo.textContent = `无法播放: ${playlist[currentTrack].title}`;
              
              // 尝试播放下一首
              setTimeout(function() {
                currentTrack = (currentTrack + 1) % playlist.length;
                loadAndPlayTrack();
              }, 2000);
            });
        } catch (error) {
          console.error('音频加载错误:', error);
          musicInfo.textContent = `错误: ${playlist[currentTrack].title}`;
          
          // 尝试播放下一首
          setTimeout(function() {
            currentTrack = (currentTrack + 1) % playlist.length;
            loadAndPlayTrack();
          }, 2000);
        }
      }
      
      // 播放/暂停
      function togglePlay() {
        if (isPlaying) {
          audioPlayer.pause();
          playPauseBtn.textContent = '▶';
          isPlaying = false;
        } else {
          loadAndPlayTrack();
        }
      }
      
      // 播放下一首
      function playNext() {
        currentTrack = (currentTrack + 1) % playlist.length;
        if (isPlaying) {
          loadAndPlayTrack();
        } else {
          updateMusicInfo();
        }
      }
      
      // 播放上一首
      function playPrev() {
        currentTrack = (currentTrack - 1 + playlist.length) % playlist.length;
        if (isPlaying) {
          loadAndPlayTrack();
        } else {
          updateMusicInfo();
        }
      }
      
      // 设置音频属性
      audioPlayer.volume = 0.3;
      
      // 进度条点击事件
      progressBar.addEventListener('click', function(e) {
        const percentage = (e.offsetX / this.offsetWidth);
        audioPlayer.currentTime = percentage * audioPlayer.duration;
      });
      
      // 绑定事件
      playPauseBtn.addEventListener('click', togglePlay);
      nextBtn.addEventListener('click', playNext);
      prevBtn.addEventListener('click', playPrev);
      volumeControl.addEventListener('input', function(e) {
        audioPlayer.volume = e.target.value;
      });
      
      // 监听播放进度
      
    
</script>

<script>
// 侧边栏功能
document.addEventListener('DOMContentLoaded', function() {
  const sidebar = document.getElementById('sidebar');
  const sidebarToggle = document.getElementById('sidebarToggle');
  const mainContent = document.querySelector('.main-content');
  
  if (!sidebar || !sidebarToggle || !mainContent) {
    console.error('侧边栏元素未找到!');
    return;
  }
  
  console.log('侧边栏元素已找到，初始化事件...');
  
  // 切换侧边栏
  sidebarToggle.addEventListener('click', function() {
    console.log('切换侧边栏');
    sidebar.classList.toggle('active');
    if (sidebar.classList.contains('active')) {
      mainContent.classList.add('sidebar-active');
    } else {
      mainContent.classList.remove('sidebar-active');
    }
  });
  
  // 点击侧边栏外关闭侧边栏
  document.addEventListener('click', function(e) {
    if (sidebar.classList.contains('active') && 
        !sidebar.contains(e.target) && 
        e.target !== sidebarToggle &&
        !sidebarToggle.contains(e.target)) {
      sidebar.classList.remove('active');
      mainContent.classList.remove('sidebar-active');
    }
  });
  
  // 高亮当前页面链接
  const currentUrl = window.location.pathname;
  const links = sidebar.querySelectorAll('a');
  links.forEach(link => {
    if (link.getAttribute('href') === currentUrl) {
      link.style.color = '#00ff9d';
      link.style.fontWeight = 'bold';
    }
  });
});
</script>





<!-- 注入的音乐播放器脚本 -->
<script>
/**
 * 音乐播放器添加脚本
 * 
 * 此脚本用于向第二章及之后的所有HTML页面添加音乐播放器组件
 * 确保在页面之间导航时音乐继续播放
 * 
 * 使用方法：
 * 1. 在浏览器控制台中运行此脚本
 * 2. 或者将其添加到HTML文件的末尾
 */

// 检查是否已经存在音乐播放器
if (document.querySelector('.xi-music-player')) {
  console.log('音乐播放器已存在，跳过添加');
} else {
  console.log('开始添加音乐播放器...');
  
  // 检查当前页面路径，确保只在第二章及之后的页面添加
  const currentPath = window.location.pathname;
  const chapterMatch = currentPath.match(/\/chapter(\d+)\//);
  
  if (chapterMatch && parseInt(chapterMatch[1]) >= 2) {
    // 添加音乐播放器
    addMusicPlayer();
    console.log('音乐播放器已添加到页面');
  } else {
    console.log('当前页面不符合添加条件（非第二章及之后页面）');
  }
}

/**
 * 添加音乐播放器到页面
 */
function addMusicPlayer() {
  // 生成唯一ID前缀，避免冲突
  const idPrefix = 'xi_player_' + Math.random().toString(36).substring(2, 9) + '_';
  
  // 1. 添加HTML结构
  const playerHTML = `
  <div class="xi-music-player">
    <button id="${idPrefix}playerToggle" class="player-toggle">
      <i class="toggle-icon">🎵</i>
    </button>
    <div class="player-container">
      <div class="player-header">
        <div id="${idPrefix}musicInfo">未播放</div>
        <div id="${idPrefix}status" style="font-size: 10px; color: #999;">状态：就绪</div>
      </div>
      <div class="player-controls">
        <button id="${idPrefix}prevTrack">⏮</button>
        <button id="${idPrefix}playPause">▶</button>
        <button id="${idPrefix}nextTrack">⏭</button>
      </div>
      <div class="progress-container">
        <div id="${idPrefix}progressBar" class="progress-bar">
          <div id="${idPrefix}progressCurrent" class="progress-current"></div>
        </div>
        <div class="progress-time">
          <span id="${idPrefix}currentTime">0:00</span> / <span id="${idPrefix}totalTime">0:00</span>
        </div>
      </div>
      <div class="volume-container">
        <label for="${idPrefix}volumeControl">音量:</label>
        <input type="range" id="${idPrefix}volumeControl" min="0" max="1" step="0.1" value="0.3">
      </div>
      <div class="playlist-container">
        <h3>播放列表</h3>
        <ul id="${idPrefix}playlist-display"></ul>
      </div>
    </div>
  </div>`;
  
  // 将播放器添加到body末尾
  const playerContainer = document.createElement('div');
  playerContainer.innerHTML = playerHTML;
  document.body.appendChild(playerContainer.firstElementChild);
  
  // 2. 添加CSS样式
  const playerStyles = `
  /* 音乐播放器样式 */
  .xi-music-player {
    position: fixed;
    bottom: 20px;
    right: 20px;
    z-index: 1000;
    font-family: 'Arial', sans-serif;
  }
  
  .xi-music-player .player-toggle {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background-color: rgba(0, 0, 0, 0.7);
    border: 2px solid #00ff9d;
    color: #00ff9d;
    font-size: 20px;
    cursor: pointer;
    position: relative;
    z-index: 1001;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  
  .xi-music-player .player-toggle:hover {
    transform: scale(1.1);
    box-shadow: 0 0 10px rgba(0, 255, 157, 0.7);
  }
  
  .xi-music-player .toggle-icon {
    font-style: normal;
  }
  
  .xi-music-player .player-container {
    position: absolute;
    bottom: 60px;
    right: 0;
    width: 300px;
    background-color: rgba(0, 0, 0, 0.8);
    border: 1px solid #00ff9d;
    border-radius: 10px;
    padding: 15px;
    color: #fff;
    transform: scale(0);
    transform-origin: bottom right;
    transition: transform 0.3s ease;
    opacity: 0;
    visibility: hidden;
    box-shadow: 0 0 15px rgba(0, 0, 0, 0.5);
  }
  
  .xi-music-player .player-container.active {
    transform: scale(1);
    opacity: 1;
    visibility: visible;
  }
  
  .xi-music-player .player-header {
    margin-bottom: 15px;
    border-bottom: 1px solid rgba(0, 255, 157, 0.3);
    padding-bottom: 10px;
  }
  
  .xi-music-player .player-header div {
    font-size: 14px;
    font-weight: bold;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    color: #00ff9d;
  }
  
  .xi-music-player .player-controls {
    display: flex;
    justify-content: space-between;
    margin-bottom: 15px;
  }
  
  .xi-music-player .player-controls button {
    background-color: transparent;
    border: 1px solid #00ff9d;
    color: #00ff9d;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    cursor: pointer;
    font-size: 16px;
    transition: all 0.2s ease;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  
  .xi-music-player .player-controls button:hover {
    background-color: rgba(0, 255, 157, 0.2);
    transform: scale(1.1);
  }
  
  .xi-music-player .progress-container {
    margin-bottom: 15px;
  }
  
  .xi-music-player .progress-bar {
    width: 100%;
    height: 6px;
    background-color: rgba(255, 255, 255, 0.2);
    border-radius: 3px;
    cursor: pointer;
    position: relative;
    margin-bottom: 5px;
  }
  
  .xi-music-player .progress-current {
    position: absolute;
    left: 0;
    top: 0;
    height: 100%;
    background-color: #00ff9d;
    border-radius: 3px;
    width: 0%;
  }
  
  .xi-music-player .progress-time {
    font-size: 12px;
    color: #ccc;
    display: flex;
    justify-content: space-between;
  }
  
  .xi-music-player .volume-container {
    display: flex;
    align-items: center;
    margin-bottom: 15px;
    font-size: 12px;
  }
  
  .xi-music-player .volume-container label {
    margin-right: 10px;
    color: #ccc;
  }
  
  .xi-music-player input[type="range"] {
    flex: 1;
    height: 5px;
    -webkit-appearance: none;
    background-color: rgba(255, 255, 255, 0.2);
    border-radius: 2px;
  }
  
  .xi-music-player input[type="range"]::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background-color: #00ff9d;
    cursor: pointer;
  }
  
  .xi-music-player .playlist-container {
    max-height: 150px;
    overflow-y: auto;
    border-top: 1px solid rgba(0, 255, 157, 0.3);
    padding-top: 10px;
  }
  
  .xi-music-player .playlist-container h3 {
    font-size: 14px;
    margin-top: 0;
    margin-bottom: 5px;
    color: #00ff9d;
  }
  
  .xi-music-player ul {
    list-style-type: none;
    padding: 0;
    margin: 0;
  }
  
  .xi-music-player ul li {
    padding: 5px;
    font-size: 12px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    cursor: pointer;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    transition: all 0.2s ease;
  }
  
  .xi-music-player ul li:hover {
    background-color: rgba(0, 255, 157, 0.2);
    color: #00ff9d;
  }
  
  /* 滚动条样式 */
  .xi-music-player .playlist-container::-webkit-scrollbar {
    width: 5px;
  }
  
  .xi-music-player .playlist-container::-webkit-scrollbar-track {
    background: rgba(0, 0, 0, 0.3);
  }
  
  .xi-music-player .playlist-container::-webkit-scrollbar-thumb {
    background: rgba(0, 255, 157, 0.5);
    border-radius: 3px;
  }
  
  .xi-music-player .playlist-container::-webkit-scrollbar-thumb:hover {
    background: rgba(0, 255, 157, 0.7);
  }
  `;
  
  // 添加样式到页面
  const styleElement = document.createElement('style');
  styleElement.textContent = playerStyles;
  document.head.appendChild(styleElement);
  
  // 3. 添加JavaScript功能
  initMusicPlayer(idPrefix);
}

/**
 * 初始化音乐播放器功能
 */
function initMusicPlayer(idPrefix) {
  // 播放列表（确保路径正确）
  const playlist = [
    {
      title: "燃烧",
      url: "/music/燃烧.mp3"
    },
    {
      title: "《Metaphysics》 (Remastered)",
      url: "/music/《Metaphysics》 (Remastered).mp3"
    },
    {
      title: "Budapest (Cover) (Remastered)",
      url: "/music/Budapest (Cover) (Remastered).mp3"
    },
    {
      title: "Moonfall",
      url: "/music/Moonfall.mp3"
    },
    {
      title: "示例 - Algorithms (电子音乐)",
      url: "/music/ambient1.mp3"
    }
  ];
  
  // 全局共享存储前缀 - 确保跨页面使用相同的键
  const storagePrefix = 'xiMusic_global_';
  
  // 状态变量
  let currentTrack = localStorage.getItem(`${storagePrefix}currentTrack`) ? parseInt(localStorage.getItem(`${storagePrefix}currentTrack`)) : 0;
  let isPlaying = localStorage.getItem(`${storagePrefix}isPlaying`) === 'true';
  let currentTime = localStorage.getItem(`${storagePrefix}currentTime`) ? parseFloat(localStorage.getItem(`${storagePrefix}currentTime`)) : 0;
  let currentVolume = localStorage.getItem(`${storagePrefix}volume`) ? parseFloat(localStorage.getItem(`${storagePrefix}volume`)) : 0.3;
  let lastUrl = localStorage.getItem(`${storagePrefix}lastUrl`) || '';
  
  // 检查是否已有音频元素 - 全局查找而不仅在当前页面
  let audioPlayer;
  const audioPlayerId = `${idPrefix}audioPlayer`;
  if (!document.getElementById(audioPlayerId)) {
    audioPlayer = document.createElement('audio');
    audioPlayer.id = audioPlayerId;
    audioPlayer.style.display = 'none';
    document.body.appendChild(audioPlayer);
  } else {
    audioPlayer = document.getElementById(audioPlayerId);
  }
  
  // 获取DOM元素
  const playerToggle = document.getElementById(`${idPrefix}playerToggle`);
  const playerContainer = document.querySelector('.xi-music-player .player-container');
  const playPauseBtn = document.getElementById(`${idPrefix}playPause`);
  const prevBtn = document.getElementById(`${idPrefix}prevTrack`);
  const nextBtn = document.getElementById(`${idPrefix}nextTrack`);
  const volumeControl = document.getElementById(`${idPrefix}volumeControl`);
  const musicInfo = document.getElementById(`${idPrefix}musicInfo`);
  const progressBar = document.getElementById(`${idPrefix}progressBar`);
  const progressCurrent = document.getElementById(`${idPrefix}progressCurrent`);
  const currentTimeDisplay = document.getElementById(`${idPrefix}currentTime`);
  const totalTimeDisplay = document.getElementById(`${idPrefix}totalTime`);
  const playlistDisplay = document.getElementById(`${idPrefix}playlist-display`);
  const statusDisplay = document.getElementById(`${idPrefix}status`);
  
  // 显示播放列表
  playlistDisplay.innerHTML = '';
  playlist.forEach(function(track, index) {
    const li = document.createElement('li');
    li.textContent = track.title;
    li.style.cursor = 'pointer';
    li.onclick = function() {
      currentTrack = index;
      localStorage.setItem(`${storagePrefix}currentTrack`, currentTrack);
      loadAndPlayTrack();
    };
    playlistDisplay.appendChild(li);
  });
  
  // 切换播放器显示
  playerToggle.addEventListener('click', function() {
    playerContainer.classList.toggle('active');
  });
  
  // 更新播放进度
  function updateProgress() {
    if (audioPlayer.duration) {
      const percentage = (audioPlayer.currentTime / audioPlayer.duration) * 100;
      progressCurrent.style.width = `${percentage}%`;
      
      // 更新时间显示
      const currentMins = Math.floor(audioPlayer.currentTime / 60);
      const currentSecs = Math.floor(audioPlayer.currentTime % 60);
      const totalMins = Math.floor(audioPlayer.duration / 60);
      const totalSecs = Math.floor(audioPlayer.duration % 60);
      
      currentTimeDisplay.textContent = `${currentMins}:${currentSecs < 10 ? '0' + currentSecs : currentSecs}`;
      totalTimeDisplay.textContent = `${totalMins}:${totalSecs < 10 ? '0' + totalSecs : totalSecs}`;
      
      // 持续保存当前播放位置 - 每秒保存一次，避免频繁写入
      if (Math.floor(audioPlayer.currentTime) % 1 === 0) {
        localStorage.setItem(`${storagePrefix}currentTime`, audioPlayer.currentTime);
      }
    }
  }
  
  // 更新音乐信息
  function updateMusicInfo() {
    musicInfo.textContent = playlist[currentTrack].title;
    if (statusDisplay) {
      statusDisplay.textContent = isPlaying ? "状态：正在播放" : "状态：已暂停";
    }
  }
  
  // 加载曲目（不自动播放）
  function loadTrack() {
    try {
      const encodedUrl = encodeURI(playlist[currentTrack].url);
      
      // 保存当前加载的URL
      localStorage.setItem(`${storagePrefix}lastUrl`, encodedUrl);
      
      // 只有URL变化时才重新加载
      if (audioPlayer.src !== encodedUrl) {
        musicInfo.textContent = `加载中... ${playlist[currentTrack].title}`;
        if (statusDisplay) statusDisplay.textContent = "状态：正在加载";
        
        audioPlayer.src = encodedUrl;
        audioPlayer.load();
        
        // 设置音量
        audioPlayer.volume = currentVolume;
        volumeControl.value = currentVolume;
      }
      
      updateMusicInfo();
      return true;
    } catch(error) {
      console.error('加载音频出错:', error);
      if (statusDisplay) statusDisplay.textContent = `状态：加载失败 - ${error.message}`;
      return false;
    }
  }
  
  // 加载并播放当前曲目
  function loadAndPlayTrack() {
    // 记住当前曲目
    localStorage.setItem(`${storagePrefix}currentTrack`, currentTrack);
    
    if (loadTrack()) {
      try {
        // 播放音频
        const playPromise = audioPlayer.play();
        if (playPromise !== undefined) {
          playPromise.then(function() {
            playPauseBtn.textContent = '⏸';
            isPlaying = true;
            localStorage.setItem(`${storagePrefix}isPlaying`, 'true');
            updateMusicInfo();
          }).catch(function(error) {
            console.error('播放错误:', error);
            musicInfo.textContent = `无法播放: ${playlist[currentTrack].title}`;
            if (statusDisplay) statusDisplay.textContent = `状态：播放失败 - ${error.message}`;
            
            // 尝试播放下一首
            setTimeout(function() {
              currentTrack = (currentTrack + 1) % playlist.length;
              localStorage.setItem(`${storagePrefix}currentTrack`, currentTrack);
              loadAndPlayTrack();
            }, 2000);
          });
        }
      } catch (error) {
        console.error('播放音频错误:', error);
        musicInfo.textContent = `错误: ${playlist[currentTrack].title}`;
        if (statusDisplay) statusDisplay.textContent = `状态：播放失败 - ${error.message}`;
        
        // 尝试播放下一首
        setTimeout(function() {
          currentTrack = (currentTrack + 1) % playlist.length;
          localStorage.setItem(`${storagePrefix}currentTrack`, currentTrack);
          loadAndPlayTrack();
        }, 2000);
      }
    }
  }
  
  // 播放/暂停
  function togglePlay() {
    if (isPlaying) {
      audioPlayer.pause();
      playPauseBtn.textContent = '▶';
      isPlaying = false;
      localStorage.setItem(`${storagePrefix}isPlaying`, 'false');
      updateMusicInfo();
    } else {
      loadAndPlayTrack();
    }
  }
  
  // 播放下一首
  function playNext() {
    currentTrack = (currentTrack + 1) % playlist.length;
    localStorage.setItem(`${storagePrefix}currentTrack`, currentTrack);
    if (isPlaying) {
      loadAndPlayTrack();
    } else {
      loadTrack();
      updateMusicInfo();
    }
  }
  
  // 播放上一首
  function playPrev() {
    currentTrack = (currentTrack - 1 + playlist.length) % playlist.length;
    localStorage.setItem(`${storagePrefix}currentTrack`, currentTrack);
    if (isPlaying) {
      loadAndPlayTrack();
    } else {
      loadTrack();
      updateMusicInfo();
    }
  }
  
  // 进度条点击事件
  progressBar.addEventListener('click', function(e) {
    if (audioPlayer.duration) {
      const percentage = (e.offsetX / this.offsetWidth);
      audioPlayer.currentTime = percentage * audioPlayer.duration;
      localStorage.setItem(`${storagePrefix}currentTime`, audioPlayer.currentTime);
    }
  });
  
  // 绑定事件
  playPauseBtn.addEventListener('click', togglePlay);
  nextBtn.addEventListener('click', playNext);
  prevBtn.addEventListener('click', playPrev);
  volumeControl.addEventListener('input', function(e) {
    audioPlayer.volume = e.target.value;
    currentVolume = e.target.value;
    localStorage.setItem(`${storagePrefix}volume`, currentVolume);
  });
  
  // 监听播放进度
  audioPlayer.addEventListener('timeupdate', updateProgress);
  
  // 监听音频结束事件
  audioPlayer.addEventListener('ended', playNext);
  
  // 保存页面卸载时的状态
  window.addEventListener('beforeunload', function() {
    localStorage.setItem(`${storagePrefix}currentTime`, audioPlayer.currentTime);
    localStorage.setItem(`${storagePrefix}isPlaying`, isPlaying ? 'true' : 'false');
    localStorage.setItem(`${storagePrefix}currentTrack`, currentTrack);
    localStorage.setItem(`${storagePrefix}volume`, audioPlayer.volume);
  });
  
  // 初始化
  if (loadTrack()) {
    // 设置音量
    audioPlayer.volume = currentVolume;
    volumeControl.value = currentVolume;
    
    // 恢复播放位置
    if (currentTime > 0 && audioPlayer.readyState >= 1) {
      try {
        audioPlayer.currentTime = currentTime;
      } catch (e) {
        console.warn('无法设置播放位置:', e);
        // 监听可以设置时间的事件
        audioPlayer.addEventListener('canplay', function onCanPlay() {
          try {
            audioPlayer.currentTime = currentTime;
            audioPlayer.removeEventListener('canplay', onCanPlay);
          } catch(e) {
            console.error('设置播放位置失败:', e);
          }
        });
      }
    }
    
    // 如果之前在播放，则恢复播放
    if (isPlaying) {
      const playPromise = audioPlayer.play();
      if (playPromise !== undefined) {
        playPromise.then(function() {
          playPauseBtn.textContent = '⏸';
          updateMusicInfo();
        }).catch(function(error) {
          console.warn('自动恢复播放失败，需要用户交互:', error);
          isPlaying = false;
          localStorage.setItem(`${storagePrefix}isPlaying`, 'false');
          playPauseBtn.textContent = '▶';
          
          // 提示用户点击播放
          if (statusDisplay) {
            statusDisplay.textContent = "状态：请点击播放按钮继续";
          }
        });
      }
    } else {
      playPauseBtn.textContent = '▶';
    }
    
    updateMusicInfo();
  }
} 
</script>
<!-- 音乐播放器注入结束 -->

</body>
</html>
